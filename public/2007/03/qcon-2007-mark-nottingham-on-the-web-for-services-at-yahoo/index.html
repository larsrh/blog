<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Stefan Tilkov">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="canonical" href="https://www.innoq.comhttps://www.innoq.com/blog/st/2007/03/qcon-2007-mark-nottingham-on-the-web-for-services-at-yahoo/">
  <link href="/blog/st/favicon.png" rel="icon">
  <link href="/blog/st/atom.xml" rel="alternate" title="Stefan Tilkov's Blog" type="application/atom+xml">


  <link rel="stylesheet" href="https://bootstrap.assets.innoq.com/css/0.0.9/innoq-bootstrap-theme.css" />
  <link rel="stylesheet" href="/blog/st/stylesheets/blog.css" />

  <title>QCon 2007: Mark Nottingham on the Web for Services at Yahoo! [Stefan Tilkov’s Blog]</title>
  
</head>


  <body>

    <nav class="navbar navbar-expand-lg navbar-light">
  <a class="navbar-brand m-2 p-2" href="https://www.innoq.com/"><img alt="INNOQ logo" height="40" src="https://innoq.style/assets/innoq-logo--whitered.svg" /></a>
  <a class="navbar-brand text-light" href="/blog/st/">Stefan Tilkov’s Blog Archive</a>
</nav>





    <main class="container">
      <p class="mt-5"><em>
	This is a single archived entry from Stefan Tilkov’s blog. For more up-to-date content,
	check out my <a href="https://www.innoq.com/en/staff/stefan-tilkov/">author page at INNOQ</a>,
	which has more information about me and also contains a list of published talks, podcasts, and articles.
	Or you can check out the <a href="/blog/st/">full archive</a>.

      </em></p>
      <article>
	<header>
          <h1>QCon 2007: Mark Nottingham on the Web for Services at Yahoo!</h1>
	  <p><small><a href="https://www.innoq.com/en/staff/stefan-tilkov/">Stefan Tilkov</a>, <time datetime="2017-06-26">Mar 16, 2007</time></small><p>
	</header>
	<section>
	  <p>4 billion daily page views (up from about 65 million in 1996). Integration nightmare for different &#8220;properties&#8221; at Yahoo!, especially because of the acquisitions (like del.icio.us), also integration with partners, and also within Yahoo over time: the infrastructure deployed in 1998 needs to be integrated with the stuff running today. Yahoo scale is another problem &#8212; a link on Yahoo home page will trigger their own version of the Slashdot effect. </p>

<p>Mark is part of the Media Group, which handles things related to content. Each media property was reinventing the wheel all of the time, until some recognized it made sense to reuse components. Initial architecure: independent front end boxes, including databases, with a master database in the backend. Problems: Large datasets don&#8217;t push well. Adding capacity is expensive &#8212; if there&#8217;s a need to extend the News property with 50 machines, if the data needs to be pushed to the frontend machines this will take to long. Another problem: what to do after a push failure, another one: user-generated content. Cross property integration, e.g. Yahoo tech which integrates products and answers from Yahoo answers. Another new property: Yahoo! pipes. Old architecture had severe problems: one frontend box requests data from another frontend box. </p>

<p>Requirements for the new architecture: massive scalability, flexible deployment, highly dynamic, separation of concerns &#8212; result. move towards a Service-oriented architecture. PHP is much more common at Yahoo! than Java. Scalability, Simplicity, Reuse, Interoperability &#8212; decision: use HTTP, not WS-*. </p>

<p>Frontend boxes make requests through a cache to backend API servers, all via HTTP. Attributes: single source of truth. Cache replicates data (pull model vs. push model). Question from the audience: is this REST? Mark doesn&#8217;t want to talk about REST because he views this as a philosophical discussion &#8212; but yes, they are RESTful. UGC pushes through. Adding capacity is easy. HTTP-based backend.</p>

<p>One example of using HTTP instead of doing a big REST pitch: Caching intermediaries. Advantages: Freshness, validation (asking &#8220;has this changed&#8221; is a quick etag-based question to the backend). Precalculated results, validated against the etag of the calculation input. Next advantage: Metrics from the cache, shows the output from an internal tool, histograms showing cache misses and hits. (Based on Squid?). More benefits: Load balancing, cache peering &#8212; multi-GB memory caches not at all uncommon. 3-4 common cache peer protocols. Negative caching: if there&#8217;s an error out of the API server, the cache will cache the error, reducing the load on the backend. Collapsed forwarding: Multiple requests from the frontend can be collapsed to a single one, another great way to mitigate traffic from the frontend. Stale-while-revalidate: while the cache is refreshing something in the backend the cache can return a stale copy; another one: stale-if-error: if there&#8217;s a problem on the backend box, it can serve a stale copy, too. Invalidation channel: out-of-band mechanism to tell the cache something has become stale (an arrow from the backend to the cache). </p>

<p>Statistics: 16000 requests per sec per core when using caching &#8212; HTTP massively scalable to 10000 parallel connections. Squid <em>is</em> being used. Caching is a commodity: right now their using Squid, but they could easily take it out and replace it with something else. </p>

<p>Pitfalls: REST vs. WS-* wars (Mark wants to stay out of these things), theory vs. practice, human-intuitive, but not programmer-intuitive (very hard to explain REST to programmers, easy to describe it to his wife), different deployment/operational concerns (people don&#8217;t really know how to handle this &#8212; they do for single applications, but that&#8217;s not very useful), formats are hard (just like in the WS-* world), format/interface proliferation (if you give developers a new protocol construction toolkit, they&#8217;ll build protocols), authentication isn&#8217;t there yet (HTTP authentication mechanisms are unbelievably primitive), tools have a way to go (tools optimized for the browsing case, not the service case; same true for intermediaries).  </p>

<p>What&#8217;s needed: tools, web description language (Mark likes WADL), data-oriented schema language (instead of something that describes markup), investment in the Atom stack (80% case use Atom/RSS to mitigate interface and format proliferation), HTTP test suite (should be standardized).</p>

<p>Unfortunately, my laptop&#8217;s battery was empty at this point in time &#8212; too bad, since there were a lot of good questions (and answers). Some that I can remember: Someone at Yahoo! Sports (who are always on the bleeding edge) seems to be doing some transactional stuff over HTTP. It would be great if the caching intermediaries actually could use the guarantees about PUT and DELETE and the fact that both they and POST invalidate a cached resource and take advantage &#8212; they don&#8217;t (this includes Squid). I tried to tempt Mark to admit that they are actually doing REST by asking about the way they build their URIs; his answer was that they don&#8217;t care about how the URIs are designed (which is fine with me), but obviously have to make sure they refer to something cacheable, i.e. &#8220;Bob&#8217;s preferences&#8221; instead of just &#8220;Preferences&#8221;. </p>

<p>Superb talk.</p>

<section class="comments">

<div class="comment" id="comment-1203">
On <a href="#comment-1203" title="Permalink to this comment">March 22, 2007 10:52 AM</a>, <a href="http://www.infoq.com" title="http://www.infoq.com" rel="nofollow">diana plesa</a>
said:
<p>Thanks for blogging about QCon! I just wanted to let you know that we quoted and linked from this entry on the over all QCon 2007 blogger&#8217;s key takeaway points and lessons learned article: <a href="http://www.infoq.com/articles/qcon-2007-bloggers-summary" rel="nofollow" /><a href="http://www.infoq.com/articles/qcon-2007-bloggers-summary" rel="nofollow">http://www.infoq.com/articles/qcon-2007-bloggers-summary</a></p>

<p>Feel free to link to it and of course blogging about this articles existence would help even more people learn from your and other bloggers takeaways.</p>

<p>Thanks again!</p>

<p>Diana
InfoQ/QCon</p>


</section>

	</section>
      </article>
    </main>

  </body>
</html>


